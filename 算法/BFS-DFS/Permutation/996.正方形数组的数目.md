```java
package com.fisec.vpn.util;


import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

//第一遍想着hard题，怕通不过，就使用list将元素保存下来了。 本题是求个数的，所以不用保存下来
class Solution {
    public int numSquarefulPerms(int[] nums) {
        List<Integer> path=new ArrayList<>();
        List<List<Integer>> res=new ArrayList<>();
        //排序
        Arrays.sort(nums);
        boolean[] isUsed=new boolean[nums.length];
        dfs(path,res,nums,isUsed);
        return res.size();
    }

    private void dfs(List<Integer> path, List<List<Integer>> res, int[] nums,boolean[] isUsed) {
        if (path.size()==nums.length){
            res.add(new ArrayList<>(path));
            return;
        }
        for (int i = 0; i < nums.length; i++) {
            //当前元素已经被选择了
            if (isUsed[i]){
                continue;
            }
            //保证数组最后的元素不重复
            if (i>0&&nums[i]==nums[i-1]&&!isUsed[i-1]){
                continue;
            }

            if (!path.isEmpty()){
                int lastNumInArr = path.get(path.size() - 1);
                int n=lastNumInArr+nums[i];
                int sqrtNum=(int) (Math.sqrt(lastNumInArr+nums[i])+0.5);
                if (sqrtNum*sqrtNum!=n){
                    continue;
                }
            }
            isUsed[i]=true;
            path.add(nums[i]);
            dfs(path,res,nums,isUsed);
            path.remove(path.size()-1);
            isUsed[i]=false;

        }
    }
}

```
